!function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports.base_tools_pushdialog=t():e.baseToolsPushdialog=t()}(window,(function(){return function(e){function t(t){for(var n,i,s=t[0],r=t[1],a=0,c=[];a<s.length;a++)i=s[a],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&c.push(o[i][0]),o[i]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);for(u&&u(t);c.length;)c.shift()()}var n={},i={0:0},o={0:0};function s(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.e=function(e){var t=[];i[e]?t.push(i[e]):0!==i[e]&&{1:1,2:1}[e]&&t.push(i[e]=new Promise((function(t,n){for(var o=e+".style.min.css",r=s.p+o,a=document.getElementsByTagName("link"),c=0;c<a.length;c++){var u=(h=a[c]).getAttribute("data-href")||h.getAttribute("href");if("stylesheet"===h.rel&&(u===o||u===r))return t()}var l=document.getElementsByTagName("style");for(c=0;c<l.length;c++){var h;if((u=(h=l[c]).getAttribute("data-href"))===o||u===r)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var o=t&&t.target&&t.target.src||r,s=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=o,delete i[e],d.parentNode.removeChild(d),n(s)},d.href=r,document.getElementsByTagName("head")[0].appendChild(d)})).then((function(){i[e]=0})));var n=o[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,i){n=o[e]=[t,i]}));t.push(n[2]=r);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=function(e){return s.p+"static/js/"+({}[e]||e)+".chunk.js"}(e);var u=new Error;a=function(t){c.onerror=c.onload=null,clearTimeout(l);var n=o[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+s+")",u.name="ChunkLoadError",u.type=i,u.request=s,n[1](u)}o[e]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="https://mjs.sinaimg.cn/umd/base_tools_pushdialog/2.2.6/",s.oe=function(e){throw console.error(e),e};var r=window["webpackJsonp@mfelibs/base_tools_pushdialog"]=window["webpackJsonp@mfelibs/base_tools_pushdialog"]||[],a=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=a;return s(s.s=3)}([function(e,t){var n=location.origin+location.pathname,i=function(e){return void 0!=e&&""!=e&&o(document.cookie,e,";","")},o=function(e,t,n,i){if(""==e)return"";t+=i=""==i?"=":i;var o=e.indexOf(t);if(o<0)return"";o+=t.length;var s=e.indexOf(n,o);return s<o&&(s=e.length),e.substring(o,s)};e.exports={collectData:function(){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,t="UNKNOW";return e&&(t=e.type||e.effectiveType||t),{connection:e,platform:navigator.platform,urlCutQueryString:n,href:location.href,useragent:navigator.userAgent,ustat:i("ustat")||""}},getCookie:i,handleResponse:function(e){var t=e.ids,n=e.resposne,i=void 0===n?{}:n,o=e.type,s=[],r={};return t.forEach((function(e){var t=i.hit&&i.hit[e];if(t){var n="gk"===o?t.rs:t;s.push(n),r[e]=n}})),{ary:s,obj:r}},handleResult:function(e,t,n){e.length?t(null,e):t(new Error("".concat(n,"id not matched")))}}},function(e,t,n){var i,o;!function(s){if(void 0===(o="function"===typeof(i=s)?i.call(t,n,t,e):i)||(e.exports=o),!0,e.exports=s(),!!0){var r=window.Cookies,a=window.Cookies=s();a.noConflict=function(){return window.Cookies=r,a}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(i){function o(){}function s(t,n,s){if("undefined"!==typeof document){"number"===typeof(s=e({path:"/"},o.defaults,s)).expires&&(s.expires=new Date(1*new Date+864e5*s.expires)),s.expires=s.expires?s.expires.toUTCString():"";try{var r=JSON.stringify(n);/^[\{\[]/.test(r)&&(n=r)}catch(u){}n=i.write?i.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in s)s[c]&&(a+="; "+c,!0!==s[c]&&(a+="="+s[c].split(";")[0]));return document.cookie=t+"="+n+a}}function r(e,n){if("undefined"!==typeof document){for(var o={},s=document.cookie?document.cookie.split("; "):[],r=0;r<s.length;r++){var a=s[r].split("="),c=a.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(a[0]);if(c=(i.read||i)(c,u)||t(c),n)try{c=JSON.parse(c)}catch(l){}if(o[u]=c,e===u)break}catch(l){}}return e?o[e]:o}}return o.set=s,o.get=function(e){return r(e,!1)},o.getJSON=function(e){return r(e,!0)},o.remove=function(t,n){s(t,"",e(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))}))},function(e,t,n){window,e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){e.exports=function(e,t,n){var i=new XMLHttpRequest,o=Object.keys(t);o.length>0&&!e.includes("?")?e+="?":o.length>0&&e.includes("?")&&(e+="&"),o.forEach((function(n,i){e+=n+"="+t[n],i<t.length-1&&(e+="&")})),i.open("GET",e,!0),i.onload=function(){try{var e=JSON.parse(i.responseText);n(null,e)}catch(t){n(t)}},i.onerror=function(e){n(e)},i.send(null)}},function(e,t){"undefined"===typeof Paho&&(Paho={}),Paho.MQTT=function(e){var t=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){if(!t.hasOwnProperty(n)){var o="Unknown property, "+n+". Valid properties are:";for(var n in t)t.hasOwnProperty(n)&&(o=o+" "+n);throw new Error(o)}if(typeof e[n]!==t[n])throw new Error(s(i.INVALID_TYPE,[typeof e[n],n]))}},n=function(e,t){return function(){return e.apply(t,arguments)}},i={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."}},o={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},s=function(e,t){var n=e.text;if(t)for(var i,o,s=0;s<t.length;s++)if(i="{"+s+"}",(o=n.indexOf(i))>0){var r=n.substring(0,o),a=n.substring(o+i.length);n=r+t[s]+a}return n},r=[0,6,77,81,73,115,100,112,3],a=[0,4,77,81,84,84,4],c=function(e,t){for(var n in this.type=e,t)t.hasOwnProperty(n)&&(this[n]=t[n])};function u(e,t){var n,i=t,o=e[t],s=o>>4,r=o&=15;t+=1;var a=0,u=1;do{if(t==e.length)return[null,i];a+=(127&(n=e[t++]))*u,u*=128}while(0!=(128&n));var l=t+a;if(l>e.length)return[null,i];var h=new c(s);switch(s){case 2:1&e[t++]&&(h.sessionPresent=!0),h.returnCode=e[t++];break;case 3:var f=r>>1&3,g=d(e,t),v=p(e,t+=2,g);t+=g,f>0&&(h.messageIdentifier=d(e,t),t+=2);var y=new Paho.MQTT.Message(e.subarray(t,l));1==(1&r)&&(y.retained=!0),8==(8&r)&&(y.duplicate=!0),y.qos=f,y.destinationName=v,h.payloadMessage=y;break;case 4:case 5:case 6:case 7:case 11:h.messageIdentifier=d(e,t);break;case 9:h.messageIdentifier=d(e,t),t+=2,h.returnCode=e.subarray(t,l)}return[h,l]}function l(e,t,n){return t[n++]=e>>8,t[n++]=e%256,n}function h(e,t,n,i){return g(e,n,i=l(t,n,i)),i+t}function d(e,t){return 256*e[t]+e[t+1]}function f(e){for(var t=0,n=0;n<e.length;n++){var i=e.charCodeAt(n);i>2047?(55296<=i&&i<=56319&&(n++,t++),t+=3):i>127?t+=2:t++}return t}function g(e,t,n){for(var o=n,r=0;r<e.length;r++){var a=e.charCodeAt(r);if(55296<=a&&a<=56319){var c=e.charCodeAt(++r);if(isNaN(c))throw new Error(s(i.MALFORMED_UNICODE,[a,c]));a=c-56320+(a-55296<<10)+65536}a<=127?t[o++]=a:a<=2047?(t[o++]=a>>6&31|192,t[o++]=63&a|128):a<=65535?(t[o++]=a>>12&15|224,t[o++]=a>>6&63|128,t[o++]=63&a|128):(t[o++]=a>>18&7|240,t[o++]=a>>12&63|128,t[o++]=a>>6&63|128,t[o++]=63&a|128)}return t}function p(e,t,n){for(var o,r="",a=t;a<t+n;){var c=e[a++];if(c<128)o=c;else{var u=e[a++]-128;if(u<0)throw new Error(s(i.MALFORMED_UTF,[c.toString(16),u.toString(16),""]));if(c<224)o=64*(c-192)+u;else{var l=e[a++]-128;if(l<0)throw new Error(s(i.MALFORMED_UTF,[c.toString(16),u.toString(16),l.toString(16)]));if(c<240)o=4096*(c-224)+64*u+l;else{var h=e[a++]-128;if(h<0)throw new Error(s(i.MALFORMED_UTF,[c.toString(16),u.toString(16),l.toString(16),h.toString(16)]));if(!(c<248))throw new Error(s(i.MALFORMED_UTF,[c.toString(16),u.toString(16),l.toString(16),h.toString(16)]));o=262144*(c-240)+4096*u+64*l+h}}}o>65535&&(o-=65536,r+=String.fromCharCode(55296+(o>>10)),o=56320+(1023&o)),r+=String.fromCharCode(o)}return r}c.prototype.encode=function(){var e=(15&this.type)<<4,t=0,n=new Array,i=0;switch(void 0!=this.messageIdentifier&&(t+=2),this.type){case 1:switch(this.mqttVersion){case 3:t+=r.length+3;break;case 4:t+=a.length+3}if(t+=f(this.clientId)+2,void 0!=this.willMessage){t+=f(this.willMessage.destinationName)+2;var o=this.willMessage.payloadBytes;o instanceof Uint8Array||(o=new Uint8Array(c)),t+=o.byteLength+2}void 0!=this.userName&&(t+=f(this.userName)+2),void 0!=this.password&&(t+=f(this.password)+2);break;case 8:e|=2;for(var s=0;s<this.topics.length;s++)n[s]=f(this.topics[s]),t+=n[s]+2;t+=this.requestedQos.length;break;case 10:for(e|=2,s=0;s<this.topics.length;s++)n[s]=f(this.topics[s]),t+=n[s]+2;break;case 6:e|=2;break;case 3:this.payloadMessage.duplicate&&(e|=8),e=e|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(e|=1),t+=(i=f(this.payloadMessage.destinationName))+2;var c=this.payloadMessage.payloadBytes;t+=c.byteLength,c instanceof ArrayBuffer?c=new Uint8Array(c):c instanceof Uint8Array||(c=new Uint8Array(c.buffer))}var u=function(e){var t=new Array(1),n=0;do{var i=e%128;(e>>=7)>0&&(i|=128),t[n++]=i}while(e>0&&n<4);return t}(t),d=u.length+1,g=new ArrayBuffer(t+d),p=new Uint8Array(g);if(p[0]=e,p.set(u,1),3==this.type)d=h(this.payloadMessage.destinationName,i,p,d);else if(1==this.type){switch(this.mqttVersion){case 3:p.set(r,d),d+=r.length;break;case 4:p.set(a,d),d+=a.length}var v=0;this.cleanSession&&(v=2),void 0!=this.willMessage&&(v|=4,v|=this.willMessage.qos<<3,this.willMessage.retained&&(v|=32)),void 0!=this.userName&&(v|=128),void 0!=this.password&&(v|=64),p[d++]=v,d=l(this.keepAliveInterval,p,d)}switch(void 0!=this.messageIdentifier&&(d=l(this.messageIdentifier,p,d)),this.type){case 1:d=h(this.clientId,f(this.clientId),p,d),void 0!=this.willMessage&&(d=h(this.willMessage.destinationName,f(this.willMessage.destinationName),p,d),d=l(o.byteLength,p,d),p.set(o,d),d+=o.byteLength),void 0!=this.userName&&(d=h(this.userName,f(this.userName),p,d)),void 0!=this.password&&(d=h(this.password,f(this.password),p,d));break;case 3:p.set(c,d);break;case 8:for(s=0;s<this.topics.length;s++)d=h(this.topics[s],n[s],p,d),p[d++]=this.requestedQos[s];break;case 10:for(s=0;s<this.topics.length;s++)d=h(this.topics[s],n[s],p,d)}return g};var v=function(e,t,n){this._client=e,this._window=t,this._keepAliveInterval=1e3*n,this.isReset=!1;var o=new c(12).encode(),r=function(e){return function(){return a.apply(e)}},a=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(o),this.timeout=this._window.setTimeout(r(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(i.PING_TIMEOUT.code,s(i.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0,this._window.clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(r(this),this._keepAliveInterval))},this.cancel=function(){this._window.clearTimeout(this.timeout)}},y=function(e,t,n,i,o){this._window=t,n||(n=30),this.timeout=setTimeout(function(e,t,n){return function(){return e.apply(t,n)}}(i,e,o),1e3*n),this.cancel=function(){this._window.clearTimeout(this.timeout)}},_=function(t,n,o,r,a){if(!("WebSocket"in e)||null===e.WebSocket)throw new Error(s(i.UNSUPPORTED,["WebSocket"]));if(!("localStorage"in e)||null===e.localStorage)throw new Error(s(i.UNSUPPORTED,["localStorage"]));if(!("ArrayBuffer"in e)||null===e.ArrayBuffer)throw new Error(s(i.UNSUPPORTED,["ArrayBuffer"]));for(var c in this._trace("Paho.MQTT.Client",t,n,o,r,a),this.host=n,this.port=o,this.path=r,this.uri=t,this.clientId=a,this._localKey=n+":"+o+("/mqtt"!=r?":"+r:"")+":"+a+":",this._msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0,localStorage)0!=c.indexOf("Sent:"+this._localKey)&&0!=c.indexOf("Received:"+this._localKey)||this.restore(c)};_.prototype.host,_.prototype.port,_.prototype.path,_.prototype.uri,_.prototype.clientId,_.prototype.socket,_.prototype.connected=!1,_.prototype.maxMessageIdentifier=65536,_.prototype.connectOptions,_.prototype.hostIndex,_.prototype.onConnectionLost,_.prototype.onMessageDelivered,_.prototype.onMessageArrived,_.prototype.traceFunction,_.prototype._msg_queue=null,_.prototype._connectTimeout,_.prototype.sendPinger=null,_.prototype.receivePinger=null,_.prototype.receiveBuffer=null,_.prototype._traceBuffer=null,_.prototype._MAX_TRACE_ENTRIES=100,_.prototype.connect=function(e){var t=this._traceMask(e,"password");if(this._trace("Client.connect",t,this.socket,this.connected),this.connected)throw new Error(s(i.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(s(i.INVALID_STATE,["already connected"]));this.connectOptions=e,e.uris?(this.hostIndex=0,this._doConnect(e.uris[0])):this._doConnect(this.uri)},_.prototype.subscribe=function(e,t){if(this._trace("Client.subscribe",e,t),!this.connected)throw new Error(s(i.INVALID_STATE,["not connected"]));var n=new c(8);n.topics=[e],void 0!=t.qos?n.requestedQos=[t.qos]:n.requestedQos=[0],t.onSuccess&&(n.onSuccess=function(e){t.onSuccess({invocationContext:t.invocationContext,grantedQos:e})}),t.onFailure&&(n.onFailure=function(e){t.onFailure({invocationContext:t.invocationContext,errorCode:e})}),t.timeout&&(n.timeOut=new y(this,window,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:i.SUBSCRIBE_TIMEOUT.code,errorMessage:s(i.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(n),this._schedule_message(n)},_.prototype.unsubscribe=function(e,t){if(this._trace("Client.unsubscribe",e,t),!this.connected)throw new Error(s(i.INVALID_STATE,["not connected"]));var n=new c(10);n.topics=[e],t.onSuccess&&(n.callback=function(){t.onSuccess({invocationContext:t.invocationContext})}),t.timeout&&(n.timeOut=new y(this,window,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:i.UNSUBSCRIBE_TIMEOUT.code,errorMessage:s(i.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(n),this._schedule_message(n)},_.prototype.send=function(e){if(this._trace("Client.send",e),!this.connected)throw new Error(s(i.INVALID_STATE,["not connected"]));wireMessage=new c(3),wireMessage.payloadMessage=e,e.qos>0?this._requires_ack(wireMessage):this.onMessageDelivered&&(this._notify_msg_sent[wireMessage]=this.onMessageDelivered(wireMessage.payloadMessage)),this._schedule_message(wireMessage)},_.prototype.disconnect=function(){if(this._trace("Client.disconnect"),!this.socket)throw new Error(s(i.INVALID_STATE,["not connecting or connected"]));wireMessage=new c(14),this._notify_msg_sent[wireMessage]=n(this._disconnected,this),this._schedule_message(wireMessage)},_.prototype.getTraceLog=function(){if(null!==this._traceBuffer){for(var e in this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length),this._sentMessages)this._trace("_sentMessages ",e,this._sentMessages[e]);for(var e in this._receivedMessages)this._trace("_receivedMessages ",e,this._receivedMessages[e]);return this._traceBuffer}},_.prototype.startTrace=function(){null===this._traceBuffer&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,"@VERSION@")},_.prototype.stopTrace=function(){delete this._traceBuffer},_.prototype._doConnect=function(e){if(this.connectOptions.useSSL){var t=e.split(":");t[0]="wss",e=t.join(":")}this.connected=!1,this.connectOptions.mqttVersion<4?this.socket=new WebSocket(e,["mqttv3.1"]):this.socket=new WebSocket(e,["mqtt"]),this.socket.binaryType="arraybuffer",this.socket.onopen=n(this._on_socket_open,this),this.socket.onmessage=n(this._on_socket_message,this),this.socket.onerror=n(this._on_socket_error,this),this.socket.onclose=n(this._on_socket_close,this),this.sendPinger=new v(this,window,this.connectOptions.keepAliveInterval),this.receivePinger=new v(this,window,this.connectOptions.keepAliveInterval),this._connectTimeout=new y(this,window,this.connectOptions.timeout,this._disconnected,[i.CONNECT_TIMEOUT.code,s(i.CONNECT_TIMEOUT)])},_.prototype._schedule_message=function(e){this._msg_queue.push(e),this.connected&&this._process_queue()},_.prototype.store=function(e,t){var n={type:t.type,messageIdentifier:t.messageIdentifier,version:1};switch(t.type){case 3:t.pubRecReceived&&(n.pubRecReceived=!0),n.payloadMessage={};for(var o="",r=t.payloadMessage.payloadBytes,a=0;a<r.length;a++)r[a]<=15?o=o+"0"+r[a].toString(16):o+=r[a].toString(16);n.payloadMessage.payloadHex=o,n.payloadMessage.qos=t.payloadMessage.qos,n.payloadMessage.destinationName=t.payloadMessage.destinationName,t.payloadMessage.duplicate&&(n.payloadMessage.duplicate=!0),t.payloadMessage.retained&&(n.payloadMessage.retained=!0),0==e.indexOf("Sent:")&&(void 0===t.sequence&&(t.sequence=++this._sequence),n.sequence=t.sequence);break;default:throw Error(s(i.INVALID_STORED_DATA,[key,n]))}localStorage.setItem(e+this._localKey+t.messageIdentifier,JSON.stringify(n))},_.prototype.restore=function(e){var t=localStorage.getItem(e),n=JSON.parse(t),o=new c(n.type,n);switch(n.type){case 3:for(var r=n.payloadMessage.payloadHex,a=new ArrayBuffer(r.length/2),u=new Uint8Array(a),l=0;r.length>=2;){var h=parseInt(r.substring(0,2),16);r=r.substring(2,r.length),u[l++]=h}var d=new Paho.MQTT.Message(u);d.qos=n.payloadMessage.qos,d.destinationName=n.payloadMessage.destinationName,n.payloadMessage.duplicate&&(d.duplicate=!0),n.payloadMessage.retained&&(d.retained=!0),o.payloadMessage=d;break;default:throw Error(s(i.INVALID_STORED_DATA,[e,t]))}0==e.indexOf("Sent:"+this._localKey)?(o.payloadMessage.duplicate=!0,this._sentMessages[o.messageIdentifier]=o):0==e.indexOf("Received:"+this._localKey)&&(this._receivedMessages[o.messageIdentifier]=o)},_.prototype._process_queue=function(){for(var e=null,t=this._msg_queue.reverse();e=t.pop();)this._socket_send(e),this._notify_msg_sent[e]&&(this._notify_msg_sent[e](),delete this._notify_msg_sent[e])},_.prototype._requires_ack=function(e){var t=Object.keys(this._sentMessages).length;if(t>this.maxMessageIdentifier)throw Error("Too many messages:"+t);for(;void 0!==this._sentMessages[this._message_identifier];)this._message_identifier++;e.messageIdentifier=this._message_identifier,this._sentMessages[e.messageIdentifier]=e,3===e.type&&this.store("Sent:",e),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},_.prototype._on_socket_open=function(){var e=new c(1,this.connectOptions);e.clientId=this.clientId,this._socket_send(e)},_.prototype._on_socket_message=function(e){this._trace("Client._on_socket_message",e.data),this.receivePinger.reset();for(var t=this._deframeMessages(e.data),n=0;n<t.length;n+=1)this._handleMessage(t[n])},_.prototype._deframeMessages=function(e){var t=new Uint8Array(e);if(this.receiveBuffer){var n=new Uint8Array(this.receiveBuffer.length+t.length);n.set(this.receiveBuffer),n.set(t,this.receiveBuffer.length),t=n,delete this.receiveBuffer}try{for(var o=0,r=[];o<t.length;){var a=u(t,o),c=a[0];if(o=a[1],null===c)break;r.push(c)}o<t.length&&(this.receiveBuffer=t.subarray(o))}catch(l){return void this._disconnected(i.INTERNAL_ERROR.code,s(i.INTERNAL_ERROR,[l.message,l.stack.toString()]))}return r},_.prototype._handleMessage=function(e){this._trace("Client._handleMessage",e);try{switch(e.type){case 2:if(this._connectTimeout.cancel(),this.connectOptions.cleanSession){for(var t in this._sentMessages){var n=this._sentMessages[t];localStorage.removeItem("Sent:"+this._localKey+n.messageIdentifier)}for(var t in this._sentMessages={},this._receivedMessages){var r=this._receivedMessages[t];localStorage.removeItem("Received:"+this._localKey+r.messageIdentifier)}this._receivedMessages={}}if(0!==e.returnCode){this._disconnected(i.CONNACK_RETURNCODE.code,s(i.CONNACK_RETURNCODE,[e.returnCode,o[e.returnCode]]));break}this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);var a=new Array;for(var u in this._sentMessages)this._sentMessages.hasOwnProperty(u)&&a.push(this._sentMessages[u]);a=a.sort((function(e,t){return e.sequence-t.sequence}));for(var h=0,d=a.length;h<d;h++)if(3==(n=a[h]).type&&n.pubRecReceived){var f=new c(6,{messageIdentifier:n.messageIdentifier});this._schedule_message(f)}else this._schedule_message(n);this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext}),this._process_queue();break;case 3:this._receivePublish(e);break;case 4:(n=this._sentMessages[e.messageIdentifier])&&(delete this._sentMessages[e.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(n.payloadMessage));break;case 5:(n=this._sentMessages[e.messageIdentifier])&&(n.pubRecReceived=!0,f=new c(6,{messageIdentifier:e.messageIdentifier}),this.store("Sent:",n),this._schedule_message(f));break;case 6:r=this._receivedMessages[e.messageIdentifier],localStorage.removeItem("Received:"+this._localKey+e.messageIdentifier),r&&(this._receiveMessage(r),delete this._receivedMessages[e.messageIdentifier]);var g=new c(7,{messageIdentifier:e.messageIdentifier});this._schedule_message(g);break;case 7:n=this._sentMessages[e.messageIdentifier],delete this._sentMessages[e.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(n.payloadMessage);break;case 9:(n=this._sentMessages[e.messageIdentifier])&&(n.timeOut&&n.timeOut.cancel(),128===e.returnCode[0]?n.onFailure&&n.onFailure(e.returnCode):n.onSuccess&&n.onSuccess(e.returnCode),delete this._sentMessages[e.messageIdentifier]);break;case 11:(n=this._sentMessages[e.messageIdentifier])&&(n.timeOut&&n.timeOut.cancel(),n.callback&&n.callback(),delete this._sentMessages[e.messageIdentifier]);break;case 13:this.sendPinger.reset();break;case 14:this._disconnected(i.INVALID_MQTT_MESSAGE_TYPE.code,s(i.INVALID_MQTT_MESSAGE_TYPE,[e.type]));break;default:this._disconnected(i.INVALID_MQTT_MESSAGE_TYPE.code,s(i.INVALID_MQTT_MESSAGE_TYPE,[e.type]))}}catch(l){return void this._disconnected(i.INTERNAL_ERROR.code,s(i.INTERNAL_ERROR,[l.message,l.stack.toString()]))}},_.prototype._on_socket_error=function(e){this._disconnected(i.SOCKET_ERROR.code,s(i.SOCKET_ERROR,[e.data]))},_.prototype._on_socket_close=function(){this._disconnected(i.SOCKET_CLOSE.code,s(i.SOCKET_CLOSE))},_.prototype._socket_send=function(e){if(1==e.type){var t=this._traceMask(e,"password");this._trace("Client._socket_send",t)}else this._trace("Client._socket_send",e);this.socket.send(e.encode()),this.sendPinger.reset()},_.prototype._receivePublish=function(e){switch(e.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(e);break;case 1:var t=new c(4,{messageIdentifier:e.messageIdentifier});this._schedule_message(t),this._receiveMessage(e);break;case 2:this._receivedMessages[e.messageIdentifier]=e,this.store("Received:",e);var n=new c(5,{messageIdentifier:e.messageIdentifier});this._schedule_message(n);break;default:throw Error("Invaild qos="+wireMmessage.payloadMessage.qos)}},_.prototype._receiveMessage=function(e){this.onMessageArrived&&this.onMessageArrived(e.payloadMessage)},_.prototype._disconnected=function(e,t){this._trace("Client._disconnected",e,t),this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&this._connectTimeout.cancel(),this._msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,1===this.socket.readyState&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1?(this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex])):(void 0===e&&(e=i.OK.code,t=s(i.OK)),this.connected?(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:e,errorMessage:t})):4===this.connectOptions.mqttVersion&&!1===this.connectOptions.mqttVersionExplicit?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:e,errorMessage:t}))},_.prototype._trace=function(){if(this.traceFunction){for(var e in arguments)"undefined"!==typeof arguments[e]&&(arguments[e]=JSON.stringify(arguments[e]));var t=Array.prototype.slice.call(arguments).join("");this.traceFunction({severity:"Debug",message:t})}if(null!==this._traceBuffer){e=0;for(var n=arguments.length;e<n;e++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),0===e||"undefined"===typeof arguments[e]?this._traceBuffer.push(arguments[e]):this._traceBuffer.push("  "+JSON.stringify(arguments[e]))}},_.prototype._traceMask=function(e,t){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=i==t?"******":e[i]);return n};var m=function(e,n,o,r){var a;if("string"!==typeof e)throw new Error(s(i.INVALID_TYPE,[typeof e,"host"]));if(2==arguments.length){r=n;var c=(a=e).match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(!c)throw new Error(s(i.INVALID_ARGUMENT,[e,"host"]));e=c[4]||c[2],n=parseInt(c[7]),o=c[8]}else{if(3==arguments.length&&(r=o,o="/mqtt"),"number"!==typeof n||n<0)throw new Error(s(i.INVALID_TYPE,[typeof n,"port"]));if("string"!==typeof o)throw new Error(s(i.INVALID_TYPE,[typeof o,"path"]));var u=-1!=e.indexOf(":")&&"["!=e.slice(0,1)&&"]"!=e.slice(-1);a="ws://"+(u?"["+e+"]":e)+":"+n+o}for(var l=0,h=0;h<r.length;h++){var d=r.charCodeAt(h);55296<=d&&d<=56319&&h++,l++}if("string"!==typeof r||l>65535)throw new Error(s(i.INVALID_ARGUMENT,[r,"clientId"]));var f=new _(a,e,n,o,r);this._getHost=function(){return e},this._setHost=function(){throw new Error(s(i.UNSUPPORTED_OPERATION))},this._getPort=function(){return n},this._setPort=function(){throw new Error(s(i.UNSUPPORTED_OPERATION))},this._getPath=function(){return o},this._setPath=function(){throw new Error(s(i.UNSUPPORTED_OPERATION))},this._getURI=function(){return a},this._setURI=function(){throw new Error(s(i.UNSUPPORTED_OPERATION))},this._getClientId=function(){return f.clientId},this._setClientId=function(){throw new Error(s(i.UNSUPPORTED_OPERATION))},this._getOnConnectionLost=function(){return f.onConnectionLost},this._setOnConnectionLost=function(e){if("function"!==typeof e)throw new Error(s(i.INVALID_TYPE,[typeof e,"onConnectionLost"]));f.onConnectionLost=e},this._getOnMessageDelivered=function(){return f.onMessageDelivered},this._setOnMessageDelivered=function(e){if("function"!==typeof e)throw new Error(s(i.INVALID_TYPE,[typeof e,"onMessageDelivered"]));f.onMessageDelivered=e},this._getOnMessageArrived=function(){return f.onMessageArrived},this._setOnMessageArrived=function(e){if("function"!==typeof e)throw new Error(s(i.INVALID_TYPE,[typeof e,"onMessageArrived"]));f.onMessageArrived=e},this._getTrace=function(){return f.traceFunction},this._setTrace=function(e){if("function"!==typeof e)throw new Error(s(i.INVALID_TYPE,[typeof e,"onTrace"]));f.traceFunction=e},this.connect=function(e){if(t(e=e||{},{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",mqttVersion:"number"}),void 0===e.keepAliveInterval&&(e.keepAliveInterval=60),e.mqttVersion>4||e.mqttVersion<3)throw new Error(s(i.INVALID_ARGUMENT,[e.mqttVersion,"connectOptions.mqttVersion"]));if(void 0===e.mqttVersion?(e.mqttVersionExplicit=!1,e.mqttVersion=4):e.mqttVersionExplicit=!0,void 0===e.password&&void 0!==e.userName)throw new Error(s(i.INVALID_ARGUMENT,[e.password,"connectOptions.password"]));if(e.willMessage){if(!(e.willMessage instanceof w))throw new Error(s(i.INVALID_TYPE,[e.willMessage,"connectOptions.willMessage"]));if(e.willMessage.stringPayload,"undefined"===typeof e.willMessage.destinationName)throw new Error(s(i.INVALID_TYPE,[typeof e.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}if("undefined"===typeof e.cleanSession&&(e.cleanSession=!0),e.hosts){if(!(e.hosts instanceof Array))throw new Error(s(i.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));if(e.hosts.length<1)throw new Error(s(i.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));for(var n=!1,r=0;r<e.hosts.length;r++){if("string"!==typeof e.hosts[r])throw new Error(s(i.INVALID_TYPE,[typeof e.hosts[r],"connectOptions.hosts["+r+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(e.hosts[r])){if(0==r)n=!0;else if(!n)throw new Error(s(i.INVALID_ARGUMENT,[e.hosts[r],"connectOptions.hosts["+r+"]"]))}else if(n)throw new Error(s(i.INVALID_ARGUMENT,[e.hosts[r],"connectOptions.hosts["+r+"]"]))}if(n)e.uris=e.hosts;else{if(!e.ports)throw new Error(s(i.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(!(e.ports instanceof Array))throw new Error(s(i.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(e.hosts.length!=e.ports.length)throw new Error(s(i.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));for(e.uris=[],r=0;r<e.hosts.length;r++){if("number"!==typeof e.ports[r]||e.ports[r]<0)throw new Error(s(i.INVALID_TYPE,[typeof e.ports[r],"connectOptions.ports["+r+"]"]));var c=e.hosts[r],u=e.ports[r],l=-1!=c.indexOf(":");a="ws://"+(l?"["+c+"]":c)+":"+u+o,e.uris.push(a)}}}f.connect(e)},this.subscribe=function(e,n){if("string"!==typeof e)throw new Error("Invalid argument:"+e);if(t(n=n||{},{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),n.timeout&&!n.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if("undefined"!==typeof n.qos&&0!==n.qos&&1!==n.qos&&2!==n.qos)throw new Error(s(i.INVALID_ARGUMENT,[n.qos,"subscribeOptions.qos"]));f.subscribe(e,n)},this.unsubscribe=function(e,n){if("string"!==typeof e)throw new Error("Invalid argument:"+e);if(t(n=n||{},{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),n.timeout&&!n.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");f.unsubscribe(e,n)},this.send=function(e,t,n,o){var r;if(0==arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(e instanceof w)&&"string"!==typeof e)throw new Error("Invalid argument:"+typeof e);if("undefined"===typeof(r=e).destinationName)throw new Error(s(i.INVALID_ARGUMENT,[r.destinationName,"Message.destinationName"]));f.send(r)}else(r=new w(t)).destinationName=e,arguments.length>=3&&(r.qos=n),arguments.length>=4&&(r.retained=o),f.send(r)},this.disconnect=function(){f.disconnect()},this.getTraceLog=function(){return f.getTraceLog()},this.startTrace=function(){f.startTrace()},this.stopTrace=function(){f.stopTrace()},this.isConnected=function(){return f.connected}};m.prototype={get host(){return this._getHost()},set host(e){this._setHost(e)},get port(){return this._getPort()},set port(e){this._setPort(e)},get path(){return this._getPath()},set path(e){this._setPath(e)},get clientId(){return this._getClientId()},set clientId(e){this._setClientId(e)},get onConnectionLost(){return this._getOnConnectionLost()},set onConnectionLost(e){this._setOnConnectionLost(e)},get onMessageDelivered(){return this._getOnMessageDelivered()},set onMessageDelivered(e){this._setOnMessageDelivered(e)},get onMessageArrived(){return this._getOnMessageArrived()},set onMessageArrived(e){this._setOnMessageArrived(e)},get trace(){return this._getTrace()},set trace(e){this._setTrace(e)}};var w=function(e){var t;if(!("string"===typeof e||e instanceof ArrayBuffer||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array))throw s(i.INVALID_ARGUMENT,[e,"newPayload"]);t=e,this._getPayloadString=function(){return"string"===typeof t?t:p(t,0,t.length)},this._getPayloadBytes=function(){if("string"===typeof t){var e=new ArrayBuffer(f(t)),n=new Uint8Array(e);return g(t,n,0),n}return t};var n=void 0;this._getDestinationName=function(){return n},this._setDestinationName=function(e){if("string"!==typeof e)throw new Error(s(i.INVALID_ARGUMENT,[e,"newDestinationName"]));n=e};var o=0;this._getQos=function(){return o},this._setQos=function(e){if(0!==e&&1!==e&&2!==e)throw new Error("Invalid argument:"+e);o=e};var r=!1;this._getRetained=function(){return r},this._setRetained=function(e){if("boolean"!==typeof e)throw new Error(s(i.INVALID_ARGUMENT,[e,"newRetained"]));r=e};var a=!1;this._getDuplicate=function(){return a},this._setDuplicate=function(e){a=e}};return w.prototype={get payloadString(){return this._getPayloadString()},get payloadBytes(){return this._getPayloadBytes()},get destinationName(){return this._getDestinationName()},set destinationName(e){this._setDestinationName(e)},get qos(){return this._getQos()},set qos(e){this._setQos(e)},get retained(){return this._getRetained()},set retained(e){this._setRetained(e)},get duplicate(){return this._getDuplicate()},set duplicate(e){this._setDuplicate(e)}},{Client:m,Message:w}}(window),t.Paho=Paho},function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function c(e){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d,f=n(1),g=function(){function e(){s(this,e),this._evtMap={},this._evtBuffer={}}return a(e,[{key:"trigger",value:function(e,t){var n=this,i=this._evtMap[e];i&&i.slice().forEach((function(e){e.apply(n,[].concat(t))}))}},{key:"triggerWithBuffer",value:function(e,t){this.trigger(e,t),this._evtBuffer[e]={args:t}}},{key:"replayBuffer",value:function(e,t){var n=this._evtBuffer[e];n&&t.apply(null,[].concat(n.args))}},{key:"on",value:function(e,t){this.replayBuffer(e,t),this._evtMap[e]?this._evtMap[e].push(t):this._evtMap[e]=[t]}},{key:"off",value:function(e,t){if(this._evtMap[e]&&t){var n=this._evtMap[e].indexOf(t);if(n>-1)return this._evtMap[e].splice(n,1)[0]}t||this._evtMap[name]&&(this._evtMap[name]=[])}}]),e}(),p=function(e){function t(e){var n,i;return s(this,t),(n=!(i=l(t).call(this))||"object"!==c(i)&&"function"!==typeof i?u(this):i).options=e,n._triggeredConnected=!1,n._connectFailTimes=0,n._maxTryConnTimes=3,n._maxTrySubTimes=3,n._subList=[],n._reconnectDelay=1e3,function(e){for(var t=["host","port","clientId","keepAliveInterval"],n=0;n<t.length;n++)if(!e[t[n]])throw new Error(t[n]+"needed");return!0}(e)&&(n.client=new f.Paho.MQTT.Client(e.host,Number(e.port),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="/mqtt",n=[];return Object.keys(e).forEach((function(t){n.push(t+"="+e[t])})),n.length>0?t+"?"+n.join("&"):t}(e.query),e.clientId),n.client.onConnectionLost=n._onConnectionLost.bind(u(n)),n.client.onMessageDelivered=n._onMessageDelivered.bind(u(n)),n.client.onMessageArrived=n._onMessageArrived.bind(u(n)),n.client.onConnected=n._onConnected.bind(u(n)),n._connect()),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),a(t,[{key:"_connect",value:function(){this.client.connect({useSSL:this.options.useSSL,onSuccess:this._onSuccess.bind(this),onFailure:this._onFailure.bind(this),keepAliveInterval:parseInt(this.options.keepAliveInterval)})}},{key:"_onConnectionLost",value:function(e){var t=this;this._connectFailTimes++,0!==e.errorCode&&this._connectFailTimes<this._maxTryConnTimes&&setTimeout((function(){t._connect()}),this._reconnectDelay)}},{key:"_onMessageDelivered",value:function(){}},{key:"_onMessageArrived",value:function(e){this.trigger("message",e.payloadString)}},{key:"_onConnected",value:function(){}},{key:"_onSuccess",value:function(){var e=this;this._connectFailTimes=0,this._subList.forEach((function(t){e.subscribe(t,!0)})),this._triggeredConnected||(this._triggeredConnected=!0,this.trigger("connected"))}},{key:"_onFailure",value:function(){var e=this;this._connectFailTimes++,this._connectFailTimes<this._maxTryConnTimes?setTimeout((function(){e._connect()}),this._reconnectDelay):this._downgradeLoop()}},{key:"_downgradeLoop",value:function(){this.trigger("shouldDowngrade")}},{key:"subscribe",value:function(e,t){t||this._subList.push(e);var n=0,i=this;!function t(){n<i._maxTrySubTimes&&(n++,i._doSub(e,(function(){}),t))}()}},{key:"_doSub",value:function(e,t,n){this.client.subscribe(e.topic,{qos:1,timeout:30,onSuccess:t,onFailure:n})}}]),t}(g),v="https://pigeon.sina.cn/sched",y="https://dpigeon.sina.cn/order/polling",_=!1,m=!1,w=[],A=[],I=new g;function b(e,t,n){t.subscribe({topic:e.topic}),e.success&&e.success(),n()}t.default={onMessage:function(e){"function"===typeof e&&I.on("_recive",e)},openMessage:function(e){return e.app=e.app||"",e.sched=e.sched||v,e.polling=e.polling||y,e.app&&(e.polling=e.polling+"?app="+e.app),new Promise((function(t,n){if(_)if(m)b(e,d,t);else var i=setInterval((function(){m&&(clearInterval(i),b(e,d,t))}),100);else _=!0,o()(e.sched,{},(function(i,s){if(i)return e.error(i);if(0==s.code){var r=s.data.broker,a=r.split(":")[1],c=r.split(":")[0],u=s.data.keepAliveInterval,l=s.data.protocol,h=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+"-"+e()+"-"+Date.now()}();(d=new p({query:{app:e.app},useSSL:"wss"===l,port:a,host:c,clientId:h,keepAliveInterval:u})).on("connected",(function(){d.subscribe({topic:e.topic}),e.success&&e.success(),m=!0,t()})),d.on("shouldDowngrade",(function(){!function(e,t,n){var i,s=(new Date).getTime(),r=0;setInterval((function(){var n=(new Date).getTime();(n-s)/1e3<r||(s=n,o()(e,{topics:i?t+":"+i:t},(function(e,t){if(e)r=10;else if(0===t.code&&t.data){var n=t.data.pollingInfo;if(n.length){var o=n[0].msgs;i=o[0]&&o[0].msgid,A=A.concat(o)}r=t.data.nextPollingInterval||10}})))}),50)}(e.polling,e.topic)})),d.on("message",(function(e){A.push(e)})),setInterval((function(){(function e(){var t=[];return A.length&&0===(t=function(e,t){var n,i=[];if("string"===typeof e)try{e=JSON.parse(e)}catch(s){return I.trigger("_error",s,e),i}var o=e.topic;try{n=JSON.parse(e.content)}catch(s){return I.trigger("_error",s,e.content),i}return t.forEach((function(e){n.data[e]&&i.push({action:e,data:n.data[e].data,topic:o})})),i}(A.shift(),w)).length?e():t})().forEach((function(t){I.trigger("_recive",{errCode:0,data:{data:t.data,action:t.action,topic:t.topic}},e)}))}),50)}else e.error&&e.error(s.msg),n(s.msg)}));w.push(e.action||"wap_push"),e.complete&&e.complete()}))},onError:function(e){"function"===typeof e&&I.on("_error",e)}}}])},function(e,t,n){"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,o=!1,s=void 0;try{for(var r,a=e[Symbol.iterator]();!(i=(r=a.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(c){o=!0,s=c}finally{try{i||null==a.return||a.return()}finally{if(o)throw s}}return n}}(e,t)||function(e,t){if(e){if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.r(t);var c=n(0),u=new(function(){function e(){s(this,e),this.listeners=void 0,this.cache=void 0,this.listeners=[],this.cache=[]}return a(e,[{key:"on",value:function(e,t,n,i,o){t=t.join(","),n=JSON.stringify(n);var s=this.getCache(e,t,n,o);if(s)return i(s.err,s.resAry,s.resObject),!1;var r=this.listeners.findIndex((function(i){return i.type===e&&i.ids===t&&i.data===n&&i.isNative===o}));return this.listeners.push({type:e,ids:t,data:n,cb:i}),-1===r}},{key:"emit",value:function(e,t,n,i,o,s,r){t=t.join(","),n=JSON.stringify(n),this.cache.push({type:e,ids:t,data:n,err:i,resAry:o,resObject:s}),this.listeners.forEach((function(a){a.type===e&&a.ids===t&&a.data===n&&a.isNative===r&&a.cb(i,o,s)}))}},{key:"getCache",value:function(e,t,n,i){var o=this.cache.findIndex((function(o){return o.type===e&&o.ids===t&&o.data===n&&o.isNative===i}));return o>-1?this.cache[o]:null}},{key:"getEmit",value:function(e,t,n,i){var o=this;return function(s,r,a){o.emit(e,t,n,s,r,a,i)}}}]),e}()),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,e),this.jsb=t.jsb,this.version=t.version||"v1",this.id_prefix=t.id_prefix||"",this.gkurl=t.gkurl||"https://gk.sina.cn/".concat(this.version,"/gkmatch"),this.qeurl=t.qeurl||"https://gk.sina.cn/".concat(this.version,"/qematch"),this.closeCache=t.closeCache}return a(e,[{key:"loadGK",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.loadGkOrQe(e,t,n,"gk")}},{key:"loadQE",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.loadGkOrQe(e,t,n,"qe")}},{key:"loadGkOrQe",value:function(e,t,n,i){var o=this;if(e=e.map((function(e){return"".concat(o.id_prefix).concat(e)})),this.closeCache||u.on(i,e,t,n)){var s="gk"===i?this.gkurl:this.qeurl;this.fetch(e,s,t,(function(s,r){var a=o.closeCache?n:u.getEmit(i,e,t);if(s)return a(s);if(r&&0==r.code){var l=Object(c.handleResponse)({ids:e,resposne:r,type:i});l.ary.length?a(null,l.ary,l.obj):a(new Error("".concat(i,"id not matched")))}else a(new Error(r.msg))}))}}},{key:"loadGkObj",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.loadGkOrQe(e,t,(function(e,t,i){n(e,i)}),"gk")}},{key:"loadQeObj",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.loadGkOrQe(e,t,(function(e,t,i){n(e,i)}),"qe")}},{key:"loadQEbyNative",value:function(e,t,n,i,o){var s=this;if(t=t.map((function(e){return"".concat(s.id_prefix).concat(e)})),this.closeCache||u.on(o,t,n,i,!0)){var r=t.join(",");JSON.parse(JSON.stringify(n)).id=r;var a=this.closeCache?i:u.getEmit(o,t,n,!0);this.jsb&&this.jsb.fetch({url:e,method:"GET",data:n,success:function(e){a(null,e)},error:function(e){a(e)}})}}},{key:"loadGKRule",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.loadGK(e,t,(function(e,t){if(e)return i(e);n.loadRuleByRss(t,i)}))}},{key:"loadQERule",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.loadQE(e,t,(function(e,t){if(e)return i(e);n.loadRuleByRss(t,i)}))}},{key:"loadRuleByRss",value:function(e,t){var n=this,i=e.length,o=0;e.forEach((function(s){var r=s.conf||s.rs.conf;n.loadScript(r.url,(function(n){++o===i&&t(n,e)}))}))}},{key:"fetch",value:function(e,t,n,i){if(t=t+"?id="+e.join(","),this.jsb)this.jsb.fetch({url:t,method:"POST",referer:"http://sina.cn",data:n,success:function(e){i(null,e)},error:function(e){i(e)}});else{var o=new XMLHttpRequest;o.open("POST",t,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE&&200===o.status)try{i(null,JSON.parse(o.responseText))}catch(e){i(e)}},o.onerror=i,n=Object.keys(n).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])})).join("&"),o.send(n)}}},{key:"loadScript",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if(!e)return t(null);var n=document.createElement("script");n.onload=function(){n.parentNode.removeChild(n),t(null)},n.onerror=function(e){n.parentNode.removeChild(n),t(e)},n.src=e,document.body.appendChild(n)}},{key:"setUrl",value:function(e){e.gkurl&&(this.gkurl=e.gkurl),e.qeurl&&(this.qeurl=e.qeurl)}},{key:"getCookie",value:function(e){return Object(c.getCookie)(e)}}]),e}();l.defaultData=Object(c.collectData)();var h=n(1),d=n.n(h),f=n(2),g=n.n(f),p={},v=!1;new(function(){function e(){var t=this;s(this,e),this.state=void 0,this.state={title:"\u70ed\u70b9\u5feb\u8baf",duration:5,icon:"data:image/png;base64,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",pushData:null,isConfReady:!1,startTime:0,endTime:24,expireDate:1/0,interval:0,gongbuId:565,gongBu:new l,isInitConf:!1,styleType:1,strategyGkId:958},this.clearTestCookie(),this.initConf().then((function(e){console.log("\u516c\u5e03\u7cfb\u7edf\u662f\u5426\u6b63\u786e:".concat(e)),console.log(t.state.isConfReady),e&&t.state.isConfReady&&t.connectMsg()})).catch((function(e){console.log(e.stack)}))}return a(e,[{key:"isAbleToShowDialogByinterval",value:function(e){var t=this.getCookieRes(),n=t.dataid,i=t.date;if(e!=n)return!0;if(i){var o=new Date(Number(i));return Date.now()-o.getTime()>60*this.state.interval*60*1e3}return!0}},{key:"getCookieRes",value:function(){var e=d.a.get("push_dialog");if(!e)return{date:"",dataid:""};var t=o(null===e||void 0===e?void 0:e.split("##"),2);return{date:t[0],dataid:t[1]}}},{key:"clearTestCookie",value:function(){-1!=location.href.indexOf("_cc0")&&d.a.remove("push_dialog",{domain:".sina.cn"})}},{key:"initConf",value:function(){var e=this,t=window.sudaLogConfig&&window.sudaLogConfig.channel||"",n=this.state.gongbuId,i=this;return new Promise((function(o,s){e.state.gongBu.loadGK(["r"+n],{sinaglobal:window.getCookie("SINAGLOBAL"),ustat:window.getCookie("ustat"),ref:window.location.href,channel:t,useragent:navigator.userAgent,pageType:window.SM&&window.SM.data&&window.SM.data.pageType||""},(function(e,t){if(console.log("push-dialog \u516c\u5e03\u7cfb\u7edf\u8bf7\u6c42\u5b8c\u6bd5",t),e)s(e);else if(t&&t[0]){if(t[0].conf&&t[0].resp&&!i.state.isInitConf){i.state.isInitConf=!0;var n=t[0].conf;n.title&&(i.state.title=n.title),n.icon&&(i.state.icon=n.icon),i.state.styleType=n.styleType?n.styleType:1,"[object Undefined]"!==Object.prototype.toString.call(n.kid)&&(i.state.kid=Number(n.kid)),"[object Undefined]"!==Object.prototype.toString.call(n.isDownload)&&(i.state.isDownload=Number(n.isDownload)),"[object Undefined]"!==Object.prototype.toString.call(n.sn)&&(i.state.sn=n.sn),i.state.duration=Number(n.duration)&&!isNaN(n.duration)?Number(n.duration):i.state.duration,i.state.endTime=Number(n.endTime)&&!isNaN(Number(n.endTime))?Number(n.endTime):i.state.endTime,i.state.startTime=Number(n.startTime)&&!isNaN(Number(n.startTime))?Number(n.startTime):i.state.startTime,i.state.interval=Number(n.interval)&&!isNaN(Number(n.interval))?Number(n.interval):i.state.interval,i.state.expireDate=Number(n.expireDate)&&!isNaN(Number(n.expireDate))?Number(n.expireDate):i.state.expireDate,isNaN(Number(n.strategyGkId))||"[object Null]"==Object.prototype.toString.call(n.strategyGkId)||(i.state.strategyGkId=n.strategyGkId),i.state.isConfReady=!0,o(!0)}}else o(!1)}))}))}},{key:"connectMsg",value:function(){console.log("connect start.....");var e,t=this,i={sched:"http://testpigeon.sina.cn:35550/sched",polling:"http://test.pigeon.sina.cn:15679/order/polling"},o={sched:"https://pigeon.sina.cn/sched",polling:"https://dpigeon.sina.cn/order/polling"},s=-1!=location.href.indexOf("mqtt_test=1")?{sched:i.sched,polling:i.polling}:{sched:o.sched,polling:o.polling};g.a.openMessage({topic:"sina_global_push",action:"wap_push",app:"sinawap",sched:s.sched,polling:s.polling,success:function(){console.log("open success.....")},error:function(e){},complete:function(){}}),g.a.onMessage((function(i){e&&clearTimeout(e),e=setTimeout((function(){console.log("msg\u6536\u5230\u5185\u5bb9\u3002\u3002\u3002\u3002",i);var e=i.data&&i.data.data;e&&(console.log("push\u5185\u5bb9\uff1a",e),t.state.pushData={title:e.title,content:e.content,url:e.url,routeuri:e.routeuri,newsid:e.newsid,dataid:e.dataid,pushtime:t.formatDate(e.pushtime)},t.isInScope()&&t.isAbleToShowDialogByinterval(e.dataid)&&!t.isExpMsg()&&t.state.pushData.url&&("1"==t.state.styleType?n.e(1).then(n.bind(null,6)).then((function(e){var n=e.default;t.showDialog(n)})).catch((function(e){console.log(e.stack)})):"2"==t.state.styleType&&n.e(2).then(n.bind(null,7)).then((function(e){var n=e.default;t.showDialog(n)})).catch((function(e){console.log(e.stack)}))))}),600)})),g.a.onError((function(e,t){console.log("\u9519\u8bef\uff1a",t,e)}))}},{key:"isInScope",value:function(){var e=new Date,t=e.getMinutes(),n=60*e.getHours()+t;return 60*this.state.startTime<n&&n<60*this.state.endTime}},{key:"showDialog",value:function(e){var t,n,i,o,s=this,r=document.querySelector(".fl_feedFous");r&&(r.className="fl_feedFous an_clo");var a=this.state.pushData,c="_push_dialog_"+Date.now(),u='data-evt="'.concat(c,'" data-dataid="').concat(null===(t=this.state.pushData)||void 0===t?void 0:t.dataid,'" data-gkid="').concat(this.state.strategyGkId,'" data-routeuri="').concat(null===(n=this.state.pushData)||void 0===n?void 0:n.routeuri,'" data-golink="').concat(null===(i=this.state.pushData)||void 0===i?void 0:i.url,'" data-link="').concat(null===(o=this.state.pushData)||void 0===o?void 0:o.url,'"'),l=e(a.content||a.title,this.state.title,this.state.icon,u),h=document.createElement("div");h.innerHTML=l,document.body.appendChild(h),window._sinaCallStrategy.on(c,(function(e){var t=e.type,n=e.data;switch(t){case"cancel":case"call_up_confirm_no":case"call_up_confirm_out_cancel":case"call_up_no_confirm_cancel":case"down_time_out_no_down":var i=function(e){if(v)return void 0===p[e]?"":p[e];v=!0;for(var t,n=location.search,i=/([?&])([^=&]+)=([^&]*)/g;t=i.exec(n);)p[t[2]]=t[3];return void 0===p[e]?"":p[e]}("wm"),o="";o=i?-1!=n.golink.indexOf("?")?"".concat(n.golink,"&wm=").concat(i):"".concat(n.golink,"?wm=").concat(i):n.golink,console.log("######\u6700\u540e\u53d6\u6d88\u65b9\u6848\u8d70\u7684link\u4e3a\uff1a",o),location.href=o}})),window._sinaCallStrategy.init(null,{needSwiperExposure:!1}),this.setCookie(this.state.pushData.dataid);var d=h.querySelector(".fl_feedFous");d.className="fl_feedFous an";var f=setTimeout((function(){d.className="fl_feedFous an_clo"}),1e3*this.state.duration);d.addEventListener("animationend",(function(){-1!=d.className.indexOf("an_clo")&&(document.body.removeChild(h),clearTimeout(f))}),!1),h.addEventListener("click",(function(e){-1!=e.target.className.indexOf("icon_b_delete")&&s.simaLog("_click","click_0802","push dialog \u5173\u95ed"),d.className="fl_feedFous an_clo"}),!1)}},{key:"simaLog",value:function(e,t,n){var i={type:e,name:t,title:n,index:0};console.log(i),window.suda_count&&window.suda_count(i)}},{key:"setCookie",value:function(e){d.a.set("push_dialog",Date.now()+"##"+e,{domain:".sina.cn",expires:7})}},{key:"isExpMsg",value:function(){if(this.state.pushData.pushtime){var e=new Date(this.state.pushData.pushtime);return Date.now()-e.getTime()>60*this.state.expireDate*1e3?(console.log("push\u6d88\u606f\u8d85\u65f6\u4e86\uff0c\u5e9f\u5f03"),!0):(console.log("push\u6d88\u606f\u6709\u6548"),!1)}return!0}},{key:"formatDate",value:function(e){return e.replace(/-/g,"/")}}]),e}())}])}));