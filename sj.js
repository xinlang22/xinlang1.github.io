!function(win,doc){"use strict";function AddHistoryUrl(obj){obj=obj||{},this.channelUrl=obj.channelUrl||location.protocol+"//"+location.hostname+"/?vt=4&urlHistory="+this.channelName(),this.startTime=0,this.endTime=0,this.init()}AddHistoryUrl.prototype={constructor:AddHistoryUrl,init:function(){this.goReturnChannel()},goReturnChannel:function(){if(this.startTime=Date.parse(new Date),this.HasHistoryUrl()){var hostLink=this.channelUrl,liveLink=location.href;history.replaceState(null,"",hostLink),history.pushState("","",liveLink),window.addEventListener("popstate",function(e){this.endTime=Date.parse(new Date),this.endTime-this.startTime>500&&location.href===hostLink&&(this.suds_count(),setTimeout((function(){location.href=hostLink}),200))}.bind(this))}},HasHistoryUrl:function(){return history.pushState&&!appType.Utils.isSinaNews()&&!appType.Utils.isQQ()&&!appType.Utils.isWeibo()&&this.isChannel()&&this.isOldAdd()&&this.isWm()&&this.isHomePage()&&this.isHttps()&&-1==location.href.indexOf("from=tqt")&&!this.isBaiduSearch()},isBaiduSearch:function(){return 1==function(sKey){sKey=sKey.replace(/([\.\[\]\$])/g,"\\$1");var rep=new RegExp(sKey+"=([^;]*)?;","i"),res=(document.cookie+";").match(rep);return res&&res[1]||""}("isBaiduSearch")||!!document.referrer.toLowerCase().indexOf("baidu.")},suds_count:function(){var channelName=this.channelName();window.suds_count&&window.suds_count({type:"sudsHistory",name:channelName,title:"回退拦截",index:0})},getUrlString:function(paraName){var sUrl=location.href;return new RegExp("(?:\\?|&){1}"+paraName+"=([^&]*)","gi").exec(sUrl),RegExp.$1},channelName:function(){return location.hostname.split(".")[0]},isChannel:function(){return-1==document.referrer.indexOf(this.channelName())},isOldAdd:function(){return-1==document.referrer.indexOf("urlHistory="+this.channelName())},isWm:function(){return 3206!=this.getUrlString("wm")},isHomePage:function(){return-1==document.referrer.indexOf("sina.cn")},isHttps:function(){return-1==document.location.href.indexOf("pos=108")}};var appType={};appType.Utils={_UA:navigator.userAgent.toLowerCase(),UAIdentify:{weibo:"weibo",qq:"qq/",sinanews:"sinanews"},isInclude:function(allStr,str){return allStr.indexOf(str)>-1},isSinaNews:function(){var _all=this.UAIdentify;return!!this.isInclude(this._UA,_all.sinanews)},isWeibo:function(){var _all=this.UAIdentify;return!!this.isInclude(this._UA,_all.weibo)},isQQ:function(){var _all=this.UAIdentify;return!!this.isInclude(this._UA,_all.qq)}},window.addEventListener("load",(function(){new AddHistoryUrl}))}(window,document);